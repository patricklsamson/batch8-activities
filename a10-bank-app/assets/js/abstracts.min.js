const console_log=()=>{console.clear(),localStorage_space()};let i,j;class Admin{constructor(username,password,adminId){this.username=username,this.password=password,this.adminId=adminId}}class ExpenseItem{constructor(name,cost,owner){this.name=name,this.cost=cost,this.owner=owner}}class User extends Admin{constructor(username,password,email,signedUp,firstName,middleName,lastName,gender,accountNumber,accountType,balance){super(username,password),this.email=email,this.firstName=firstName,this.middleName=middleName,this.lastName=lastName,this.gender=gender,this.accountNumber=accountNumber,this.accountType=accountType,this.balance=balance,this.budget=balance,this.signedUp=signedUp,this.transactionHistory=[],this.userTransactionHistory=[],this.expenseItems=[],this.connections=[]}static get_budget(owner){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner);null!=users[ownerCheck]&&(id("owner-balance").innerHTML="",id("owner-balance").innerHTML=num_commas(users[ownerCheck].budget),users[ownerCheck].budget<0?add_class(id("budget"),"negative"):remove_class(id("budget"),"negative"))}static total_expenses(owner){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner),total=0;if(null!=users[ownerCheck]){for(id("owner-expenses").innerHTML="",i=0;i<users[ownerCheck].expenseItems.length;i++)total=parseFloat(total+parseFloat(users[ownerCheck].expenseItems[i].cost));id("owner-expenses").innerHTML=num_commas(total.toFixed(2))}}static add(name,cost,owner){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner),nameCheck=users[ownerCheck].expenseItems.findIndex(index=>index.name==name);if(users[ownerCheck].expenseItems[nameCheck])alert("Expense item already exists!");else{const newExpenseItem=new ExpenseItem(name,cost,owner);users[ownerCheck].budget=parseFloat(parseFloat(users[ownerCheck].budget)-parseFloat(cost)).toFixed(2),users[ownerCheck].expenseItems.push(newExpenseItem),localStorage.setItem("users",JSON.stringify(users)),id("add-expense-form").reset()}}static list(owner){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner);if(null!=users[ownerCheck])for(id("expense-table").innerHTML="",i=0;i<users[ownerCheck].expenseItems.length;i++){let tableRow=create_el("tr"),nameTd=create_el("td"),costTd=create_el("td"),editTd=create_el("td"),deleteTd=create_el("td");nameTd.innerHTML=users[ownerCheck].expenseItems[i].name,tableRow.appendChild(nameTd),costTd.innerHTML=`â‚±${num_commas(users[ownerCheck].expenseItems[i].cost)}`,tableRow.appendChild(costTd),editTd.innerHTML=`<i id="${i}" class="fas fa-edit"></i>`,add_event(editTd.querySelector("i"),"click",(function(){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner);id("add-expense-name").value=users[ownerCheck].expenseItems[this.id].name,id("add-expense-amount").value=num_commas(users[ownerCheck].expenseItems[this.id].cost.split(".")[0]),id("add-expense-amount-dec").value=users[ownerCheck].expenseItems[this.id].cost.split(".")[1],users[ownerCheck].budget=parseFloat(parseFloat(users[ownerCheck].budget)+parseFloat(users[ownerCheck].expenseItems[this.id].cost)).toFixed(2),users[ownerCheck].expenseItems.splice(this.id,1),localStorage.setItem("users",JSON.stringify(users)),User.list(id("owner-acc-num").innerHTML.split(" ").join("")),FnHandler.individual_history(id("owner-acc-num").innerHTML.split(" ").join("")),FnHandler.list_users(),User.get_budget(id("owner-acc-num").innerHTML.split(" ").join("")),User.total_expenses(id("owner-acc-num").innerHTML.split(" ").join(""))})),tableRow.appendChild(editTd),deleteTd.innerHTML=`<i id="${i}" class="fas fa-minus-circle"></i>`,add_event(deleteTd.querySelector("i"),"click",(function(){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==owner),deletePrompt=prompt('Are you sure to delete this item?\n Type "Y" for yes and "N" for no.',"N"),deleteAnswer;"y"==(null!=deletePrompt?trim(deletePrompt.toLowerCase()):console_log())&&(users[ownerCheck].budget=parseFloat(parseFloat(users[ownerCheck].budget)+parseFloat(users[ownerCheck].expenseItems[this.id].cost)).toFixed(2),users[ownerCheck].expenseItems.splice(this.id,1),localStorage.setItem("users",JSON.stringify(users)),User.list(id("owner-acc-num").innerHTML.split(" ").join("")),FnHandler.individual_history(id("owner-acc-num").innerHTML.split(" ").join("")),FnHandler.list_users(),User.get_budget(id("owner-acc-num").innerHTML.split(" ").join("")),User.total_expenses(id("owner-acc-num").innerHTML.split(" ").join("")))})),tableRow.appendChild(deleteTd),id("expense-table").appendChild(tableRow)}}}class FnHandler{static adminStorage(){let admin;return admin=null===localStorage.getItem("admin")?[]:JSON.parse(localStorage.getItem("admin")),admin}static addAdmin(adminAccount){const admin=FnHandler.adminStorage();admin.push(adminAccount),localStorage.setItem("admin",JSON.stringify(admin))}static userStorage(){let users;return users=null===localStorage.getItem("users")?[]:JSON.parse(localStorage.getItem("users")),users}static addUser(userAccount){const users=FnHandler.userStorage();users.push(userAccount),localStorage.setItem("users",JSON.stringify(users))}static add_connections(user,name,connection){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==user),accountNumberCheck=users.findIndex(index=>index.accountNumber==connection);for(i=0;i<users[ownerCheck].connections.length;i++)if(users[ownerCheck].connections[i].accountNumber==connection)return void alert("Connection already exists!");null==users[accountNumberCheck]||""==users[accountNumberCheck]?alert("User not found"):user==connection?alert("Cannot add own account number!"):(users[ownerCheck].connections.push({name:name,accountNumber:connection}),remove_class(id("connections-form"),"show"),id("connections-form").reset(),localStorage.setItem("users",JSON.stringify(users)))}static list_connections(user){const users=FnHandler.userStorage();let ownerCheck=users.findIndex(index=>index.accountNumber==user);if(null!=users[ownerCheck])for(id("connections-table").innerHTML="",i=0;i<users[ownerCheck].connections.length;i++){let tableRow=create_el("tr"),nameTd=create_el("td"),accNumTd=create_el("td"),editTd=create_el("td"),deleteTd=create_el("td");nameTd.innerHTML=users[ownerCheck].connections[i].name,tableRow.appendChild(nameTd),accNumTd.innerHTML=num_space(users[ownerCheck].connections[i].accountNumber),FnHandler.click_copy(accNumTd),tableRow.appendChild(accNumTd),editTd.innerHTML=`<i id="${i}" class="fas fa-edit"></i>`,add_event(editTd.querySelector("i"),"click",(function(){return has_class(id("connections-form"),"show")||add_class(id("connections-form"),"show"),id("connections-name").value=users[ownerCheck].connections[this.id].name,id("connections-account-num").value=users[ownerCheck].connections[this.id].accountNumber,users[ownerCheck].connections.splice(this.id,1),localStorage.setItem("users",JSON.stringify(users)),FnHandler.list_connections(id("owner-acc-num").innerHTML.split(" ").join(""))})),tableRow.appendChild(editTd),deleteTd.innerHTML=`<i id="${i}" class="fas fa-minus-circle"></i>`,add_event(deleteTd.querySelector("i"),"click",(function(){let deletePrompt=prompt('Are you sure to delete this connection?\nType "Y" for yes and "N" for no.',"N"),deleteAnswer;return"y"==(null!=deletePrompt?trim(deletePrompt.toLowerCase()):console_log())?(users[ownerCheck].connections.splice(this.id,1),localStorage.setItem("users",JSON.stringify(users)),FnHandler.list_connections(id("owner-acc-num").innerHTML.split(" ").join(""))):void 0})),tableRow.appendChild(deleteTd),id("connections-table").appendChild(tableRow)}}static click_copy(element){add_event(element,"click",()=>{document.execCommand("copy")}),add_event(element,"copy",e=>{e.preventDefault(),e.clipboardData&&e.clipboardData.setData("text/plain",element.textContent)})}static individual_history(user){const users=FnHandler.userStorage();let accountNumCheck=users.findIndex(index=>index.accountNumber==user);if(null!=users[accountNumCheck])for(id("owner-transaction").innerHTML="",i=0;i<users[accountNumCheck].userTransactionHistory.length;i++){let transactionLi=create_el("li"),noTransact=create_el("li");1==users[accountNumCheck].userTransactionHistory.length&&(noTransact.innerHTML="No other transactions yet.",id("owner-transaction").appendChild(noTransact)),transactionLi.innerHTML=users[accountNumCheck].userTransactionHistory[i],add_class(transactionLi,"mb-05"),id("owner-transaction").appendChild(transactionLi)}}static login_user(username,password){const admin=FnHandler.adminStorage(),users=FnHandler.userStorage();let usernameCheck=users.findIndex(index=>index.username==username),passwordCheck=users.findIndex(index=>index.password==password);if(remove_class(document.body,"y-hidden"),admin[0].username==username&&admin[0].password==password)toggle_class(id("modal"),"hide"),add_class(id("expense-wrap"),"hide"),add_class(id("connections-wrap"),"hide"),id("withdraw-account").removeAttribute("value"),id("deposit-account").removeAttribute("value"),id("sender-account").removeAttribute("value"),add_event(id("admin-settings-form"),"submit",e=>{if(e.preventDefault(),admin[0].password!=inner(id("admin-old-password").value))alert("Old password wrong!");else if(inner(id("admin-old-password").value)==inner(id("admin-confirm-new-password").value))alert("There have been no changes made for the password!");else if(inner(id("admin-new-password").value)!=inner(id("admin-confirm-new-password").value))alert("New password entries do not match!");else if(inner(id("admin-confirm-new-password").value).length<5){let passwordPrompt=prompt('Are you sure to have a weak password?\nType "Y" for yes and "N" for no.',"N"),passwordAnswer;if("y"!=(null!=passwordPrompt?passwordPrompt.toLowerCase():console_log()))return;admin[0].password=inner(id("admin-confirm-new-password").value),id("admin-settings-form").reset(),remove_class(id("admin-change-match-msg"),"fa-check"),remove_class(id("admin-change-match-msg"),"fa-times"),alert("Change password successful!"),localStorage.setItem("admin",JSON.stringify(admin))}else admin[0].password=inner(id("admin-confirm-new-password").value),id("admin-settings-form").reset(),remove_class(id("admin-change-match-msg"),"fa-check"),remove_class(id("admin-change-match-msg"),"fa-times"),alert("Change password successful!"),localStorage.setItem("admin",JSON.stringify(admin));return!1});else if(users[usernameCheck]&&users[passwordCheck]&&usernameCheck==passwordCheck){for(add_class(document.body,"user"),i=0;i<users.length;i++)users[i].username==username&&users[i].password==password&&(setTimeout(()=>{toggle_class(id("modal"),"hide"),add_class(id("withdraw-form"),"hide"),add_class(id("deposit-form"),"hide"),add_class(id("send-form"),"hide")},250),add_class(id("admin-settings-form"),"hide"),add_class(id("user-settings-form"),"show"),add_class(id("accounts-wrap"),"hide"),add_class(id("add-newaccount-wrap"),"hide"));id("owner").innerHTML=`${users[usernameCheck].firstName} ${users[usernameCheck].middleName} ${users[usernameCheck].lastName}`,id("owner-acc-num").innerHTML=num_space(users[usernameCheck].accountNumber),FnHandler.individual_history(id("owner-acc-num").innerHTML.split(" ").join("")),id("profile-name").innerHTML=`${users[usernameCheck].firstName} ${users[usernameCheck].middleName} ${users[usernameCheck].lastName}`,id("profile-acc-type").innerHTML=users[usernameCheck].accountType,id("profile-username").innerHTML=users[usernameCheck].username,id("profile-email").innerHTML=users[usernameCheck].email,id("profile-gender").innerHTML=users[usernameCheck].gender.substring(0,1).toUpperCase()+users[usernameCheck].gender.substring(1).toLowerCase(),add_att(id("withdraw-account"),"value",id("owner-acc-num").innerHTML),add_att(id("deposit-account"),"value",id("owner-acc-num").innerHTML),add_att(id("sender-account"),"value",id("owner-acc-num").innerHTML),add_event(id("change-email-form"),"submit",e=>(e.preventDefault(),users[usernameCheck].email==inner(trim(id("change-email").value))?alert("There have been no changes made for the email!"):(users[usernameCheck].email=inner(trim(id("change-email").value)),id("profile-email").innerHTML=inner(trim(id("change-email").value)),alert("Change email successful!"),localStorage.setItem("users",JSON.stringify(users))),id("change-email-form").reset(),!1)),add_event(id("change-username-form"),"submit",e=>{for(e.preventDefault(),i=0;i<users.length;i++)if(users[i].username==inner(trim(id("change-username").value)))return void alert("Username already used!");return id("change-username").value.length<5?alert("Username cannot be less than 5 characters!"):(users[usernameCheck].username=inner(trim(id("change-username").value)),id("profile-username").innerHTML=inner(trim(id("change-username").value)),alert("Change username successful!"),localStorage.setItem("users",JSON.stringify(users))),id("change-username-form").reset(),!1}),add_event(id("change-password-form"),"submit",e=>{if(e.preventDefault(),users[usernameCheck].password!=inner(id("old-password").value))alert("Old password wrong!");else if(inner(id("old-password").value)==inner(id("confirm-new-password").value))alert("There have been no changes made for the password!");else if(inner(id("new-password").value)!=inner(id("confirm-new-password").value))alert("New password entries do not match!");else if(inner(id("confirm-new-password").value).length<5){let passwordPrompt=prompt('Are you sure to have a weak password?\nType "Y" for yes and "N" for no.',"N"),passwordAnswer;if("y"!=(null!=passwordPrompt?trim(passwordPrompt.toLowerCase()):console_log()))return;users[usernameCheck].password=inner(id("confirm-new-password").value),id("change-password-form").reset(),remove_class(id("change-match-msg"),"fa-check"),remove_class(id("change-match-msg"),"fa-times"),alert("Change password successful!"),localStorage.setItem("users",JSON.stringify(users))}else users[usernameCheck].password=inner(id("confirm-new-password").value),id("change-password-form").reset(),remove_class(id("change-match-msg"),"fa-check"),remove_class(id("change-match-msg"),"fa-times"),alert("Change password successful!"),localStorage.setItem("users",JSON.stringify(users));return!1}),add_event(id("clear-items-btn"),"click",()=>{const users=FnHandler.userStorage();let usernameCheck=users.findIndex(index=>index.username==username);if(0!=users[usernameCheck].expenseItems.length){let deletePrompt=prompt('Are you sure to delete all items?\nType "Y" for yes and "N" for no.',"N"),deleteAnswer;if("y"!=(null!=deletePrompt?trim(deletePrompt.toLowerCase()):console_log()))return;{let total=0;for(i=0;i<users[usernameCheck].expenseItems.length;i++)total=parseFloat(total+parseFloat(users[usernameCheck].expenseItems[i].cost));users[usernameCheck].budget=parseFloat(parseFloat(users[usernameCheck].budget)+total),users[usernameCheck].expenseItems=[],localStorage.setItem("users",JSON.stringify(users)),User.list(id("owner-acc-num").innerHTML.split(" ").join("")),FnHandler.individual_history(id("owner-acc-num").innerHTML.split(" ").join("")),User.get_budget(id("owner-acc-num").innerHTML.split(" ").join("")),User.total_expenses(id("owner-acc-num").innerHTML.split(" ").join(""))}}})}else users[usernameCheck]?alert("Username and password do not match!"):alert("User does not exist!");setTimeout(()=>{id("login-form").reset()},500)}static signup_user(firstName,middleName,lastName,gender,username,password,confirmPassword,email,accountNumber){const users=FnHandler.userStorage();let firstNameCheck=users.findIndex(index=>index.firstName==firstName),middleNameCheck=users.findIndex(index=>index.middleName==middleName),lastNameCheck=users.findIndex(index=>index.lastName==lastName),accountNumberCheck=users.findIndex(index=>index.accountNumber==accountNumber),usernameCheck=users.findIndex(index=>index.username==username),passwordCheck=users.findIndex(index=>index.password==password),emailCheck=users.findIndex(index=>index.email==email);if(users[accountNumberCheck].signedUp)return toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show"),remove_class(id("match-msg"),"fa-check"),remove_class(id("match-msg"),"fa-times"),alert("You have already signed up!"),void id("signup-form").reset();for(i=0;i<users.length;i++)if(users[i].username==username)return void alert("Username already used!");if(null==users[firstNameCheck]||""==users[firstNameCheck]||null==users[middleNameCheck]||""==users[middleNameCheck]||null==users[lastNameCheck]||""==users[lastNameCheck]||users[accountNumberCheck].gender!=gender||null==users[accountNumberCheck]||""==users[accountNumberCheck])alert("User not found!");else if(username.length<5)alert("Username cannot be less than 5 characters!");else if(password!=confirmPassword)alert("Password entries do not match!");else if(confirmPassword.length<5){let passwordPrompt=prompt('Are you sure to have a weak password?\nType "Y" for yes and "N" for no.',"N"),passwordAnswer;if("y"!=(null!=passwordPrompt?trim(passwordPrompt.toLowerCase()):console_log())||null!=users[usernameCheck]&&""!=users[usernameCheck]&&null!=users[passwordCheck]&&""!=users[passwordCheck]&&null!=users[emailCheck]&&""!=users[emailCheck])return;toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show"),users[accountNumberCheck].username=username,users[accountNumberCheck].password=confirmPassword,users[accountNumberCheck].email=email,users[accountNumberCheck].signedUp=!0,alert("You have successfuly signed up!"),remove_class(id("match-msg"),"fa-check"),remove_class(id("match-msg"),"fa-times"),id("signup-form").reset()}else null!=users[usernameCheck]&&""!=users[usernameCheck]&&null!=users[passwordCheck]&&""!=users[passwordCheck]&&null!=users[emailCheck]&&""!=users[emailCheck]||(toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show"),users[accountNumberCheck].username=username,users[accountNumberCheck].password=confirmPassword,users[accountNumberCheck].email=email,users[accountNumberCheck].signedUp=!0,alert("You have successfuly signed up!"),remove_class(id("match-msg"),"fa-check"),remove_class(id("match-msg"),"fa-times"),id("signup-form").reset());localStorage.setItem("users",JSON.stringify(users))}static time_stamp(){const today=new Date,month=today.getMonth()<10?`0${today.getMonth()+1}`:today.getMonth()+1,date=today.getDate()<10?`0${today.getDate()}`:today.getDate(),dateFull=`${month}/${date}/${today.getFullYear()}`,hour=today.getHours()<10?`0${today.getHours()}`:today.getHours(),minute=today.getMinutes()<10?`0${today.getMinutes()}`:today.getMinutes(),seconds=today.getSeconds()<10?`0${today.getSeconds()}`:today.getSeconds(),timeFull=`${hour}:${minute}:${seconds}`;return`${dateFull} - ${timeFull}`}static withdraw(user,amount){const users=FnHandler.userStorage();let userCheck=users.findIndex(index=>index.accountNumber==user);if(null==users[userCheck]||""==users[userCheck])alert("User not found!");else if(parseFloat(users[userCheck].balance)<parseFloat(amount))alert("Not enough money!");else if(null==parseFloat(amount)||""==parseFloat(amount))alert("Enter an amount!");else{let gender="male"==users[userCheck].gender?"His":"Her";users[userCheck].balance=parseFloat(parseFloat(users[userCheck].balance)-parseFloat(amount)).toFixed(2),users[userCheck].budget=parseFloat(parseFloat(users[userCheck].budget)-parseFloat(amount)).toFixed(2);let initialBal=parseFloat(parseFloat(users[userCheck].balance)+parseFloat(amount)).toFixed(2);users[userCheck].transactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Withdrawal transaction amounting to <strong>â‚±${num_commas(amount)}</strong> from <strong>${users[userCheck].firstName}</strong>'s account has been successful. ${gender} remaining account balance is now <strong>â‚±${num_commas(users[userCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(initialBal)}</strong>.`),users[userCheck].userTransactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Withdrawal transaction amounting to <strong>â‚±${num_commas(amount)}</strong> from your account has been successful. Your remaining account balance is now <strong>â‚±${num_commas(users[userCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(initialBal)}</strong>.`),alert("Withdrawal transaction has been successful!"),localStorage.setItem("users",JSON.stringify(users))}}static deposit(user,amount){const users=FnHandler.userStorage();let userCheck=users.findIndex(index=>index.accountNumber==user);if(null==users[userCheck]||""==users[userCheck])alert("User not found!");else if(null==parseFloat(amount)||""==parseFloat(amount))alert("Enter an amount!");else{let gender="male"==users[userCheck].gender?"His":"Her";users[userCheck].balance=parseFloat(parseFloat(users[userCheck].balance)+parseFloat(amount)).toFixed(2),users[userCheck].budget=parseFloat(parseFloat(users[userCheck].budget)+parseFloat(amount)).toFixed(2);let initialBal=parseFloat(parseFloat(users[userCheck].balance)-parseFloat(amount)).toFixed(2);users[userCheck].transactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Deposit transaction amounting to <strong>â‚±${num_commas(amount)}</strong> into <strong>${users[userCheck].firstName}</strong>'s account has been successful. ${gender} account balance is now <strong>â‚±${num_commas(users[userCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(initialBal)}</strong>.`),users[userCheck].userTransactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Deposit transaction amounting to <strong>â‚±${num_commas(amount)}</strong> into your account has been successful. Your account balance is now <strong>â‚±${num_commas(users[userCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(initialBal)}</strong>.`),alert("Deposit transaction account has been successful!"),localStorage.setItem("users",JSON.stringify(users))}}static send(from_user,to_user,amount){const users=FnHandler.userStorage();let senderCheck=users.findIndex(index=>index.accountNumber==from_user),receiverCheck=users.findIndex(index=>index.accountNumber==to_user);if(null!=users[senderCheck]&&""!=users[senderCheck]||null!=users[receiverCheck]&&""!=users[receiverCheck])if(null==users[senderCheck]||""==users[senderCheck])alert("Sender's account not found!");else if(null==users[receiverCheck]||""==users[receiverCheck])alert("Receiver's account not found!");else if(parseFloat(users[senderCheck].balance)<parseFloat(amount))alert("Not enough money!");else if(null==parseFloat(amount)||""==parseFloat(amount))alert("Enter an amount!");else if(users[senderCheck].accountNumber==users[receiverCheck].accountNumber)alert("Account number entries are not allowed!");else{let senderGender="male"==users[senderCheck].gender?"his":"her",receiverGender="male"==users[receiverCheck].gender?"his":"her";users[senderCheck].balance=parseFloat(parseFloat(users[senderCheck].balance)-parseFloat(amount)).toFixed(2),users[senderCheck].budget=parseFloat(parseFloat(users[senderCheck].budget)-parseFloat(amount)).toFixed(2);let senderInitialBal=parseFloat(parseFloat(users[senderCheck].balance)+parseFloat(amount)).toFixed(2);users[senderCheck].transactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Incoming money transfer amounting to <strong>â‚±${num_commas(amount)}</strong> from <strong>${users[senderCheck].firstName}</strong>'s account into ${users[receiverCheck].firstName}'s account has been successful. <strong>${users[senderCheck].firstName}</strong>'s remaining account balance is now <strong>â‚±${num_commas(users[senderCheck].balance)}</strong> from ${senderGender} previous account balance of <strong>â‚±${num_commas(senderInitialBal)}</strong>.`),users[senderCheck].userTransactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Incoming money transfer amounting to <strong>â‚±${num_commas(amount)}</strong> from your account into ${users[receiverCheck].firstName}'s account has been successful. Your remaining account balance is now <strong>â‚±${num_commas(users[senderCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(senderInitialBal)}</strong>.`),users[receiverCheck].balance=parseFloat(parseFloat(users[receiverCheck].balance)+parseFloat(amount)).toFixed(2);let receiverInitialBal=parseFloat(parseFloat(users[receiverCheck].balance)-parseFloat(amount)).toFixed(2);users[receiverCheck].transactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Incoming money transfer amounting to <strong>â‚±${num_commas(amount)}</strong> from ${users[senderCheck].firstName}'s account into <strong>${users[receiverCheck].firstName}</strong>'s account has been successful. <strong>${users[receiverCheck].firstName}</strong>'s account balance is now <strong>â‚±${num_commas(users[receiverCheck].balance)}</strong> from ${receiverGender} previous account balance of <strong>â‚±${num_commas(receiverInitialBal)}</strong>.`),users[receiverCheck].userTransactionHistory.unshift(`<em>${FnHandler.time_stamp()}</em> : Incoming money transfer amounting to <strong>â‚±${num_commas(amount)}</strong> from ${users[senderCheck].firstName}'s account into your account has been successful. Your account balance is now <strong>â‚±${num_commas(users[receiverCheck].balance)}</strong> from a previous account balance of <strong>â‚±${num_commas(receiverInitialBal)}</strong>.`),alert("Money transfer has been successful!"),localStorage.setItem("users",JSON.stringify(users))}else alert("Users not found!")}static get_balance(user,parentEl){const users=FnHandler.userStorage();let userCheck=users.findIndex(index=>index.accountNumber==user),balanceTd=create_el("td");users[userCheck]&&(balanceTd.innerHTML=`â‚±${num_commas(users[userCheck].balance)}`,parentEl.appendChild(balanceTd))}static list_users(){const users=FnHandler.userStorage();for(id("acc-table").innerHTML="",i=0;i<users.length;i++){let tableRow=create_el("tr"),accNumTd=create_el("td"),accTd=create_el("td"),accTdSpan=create_el("span"),accTypeTd=create_el("td"),deleteTd=create_el("td"),historyModal=create_el("div"),historyModalClose=create_el("i"),historyUl=create_el("ul"),noTransact=create_el("li");for(accNumTd.innerHTML=num_space(users[i].accountNumber),tableRow.appendChild(accNumTd),FnHandler.click_copy(accNumTd),accTdSpan.innerHTML=`${users[i].firstName} ${users[i].middleName} ${users[i].lastName}`,add_event(accTdSpan,"click",()=>{add_class(document.body,"show"),add_class(historyModal,"show")}),add_class(historyModalClose,"far"),add_class(historyModalClose,"fa-times-circle"),add_class(historyModalClose,"fa-2x"),add_class(historyUl,"xbul"),add_class(historyUl,"wrap-scroll"),add_event(historyModalClose,"click",()=>{remove_class(document.body,"show"),remove_class(historyModal,"show")}),1==users[i].transactionHistory.length&&(noTransact.innerHTML="No other transactions yet.",historyUl.appendChild(noTransact)),j=0;j<users[i].transactionHistory.length;j++){let historyLi=create_el("li");historyLi.innerHTML=users[i].transactionHistory[j],add_class(historyLi,"mb-05"),historyUl.appendChild(historyLi)}historyModal.appendChild(historyModalClose),historyModal.appendChild(historyUl),accTd.appendChild(accTdSpan),accTd.appendChild(historyModal),tableRow.appendChild(accTd),accTypeTd.innerHTML=users[i].accountType,tableRow.appendChild(accTypeTd),deleteTd.innerHTML=`<i id="${users.indexOf(users[i])}" class="fas fa-minus-circle"></i>`,add_event(deleteTd.querySelector("i"),"click",(function(){let deletePrompt=prompt('Are you sure to delete this account?\nType "Y" for yes and "N" for no.',"N"),deleteAnswer;"y"==(null!=deletePrompt?trim(deletePrompt.toLowerCase()):console_log())&&(users.splice(this.id,1),localStorage.setItem("users",JSON.stringify(users)),FnHandler.list_users())})),FnHandler.get_balance(users[i].accountNumber,tableRow),tableRow.appendChild(deleteTd),add_class(tableRow,users[i].accountType.toLowerCase()),id("acc-table").appendChild(tableRow)}}static first_char(){qsel_all("[id*='-name']").forEach(input=>{add_event(input,"keyup",()=>{input.value.length>0&&!(input.value.charCodeAt(0)>31&&(input.value.charCodeAt(0)<48||input.value.charCodeAt(0)>57))&&(alert("Invalid input!"),input.value="")})})}static negative_char(){qsel_all("[id*='-amount']").forEach(input=>{add_event(input,"keyup",e=>{189==(e.which||e.keyCode)&&(alert("Amount cannot be negative!"),input.id.includes("dec")?input.value="00":input.value="")})})}static num_only(){qsel_all("[id*='-account']").forEach(input=>{add_att(input,"onkeypress","return num_only(event)")}),qsel_all("[id*='-amount']").forEach(input=>{add_att(input,"onkeypress","return num_only(event)")})}static type_comma(){qsel_all("[id*='-amount']").forEach(input=>{add_event(input,"keyup",e=>{e.which>=37&&e.which<=40||e.keyCode>=37&&e.keyCode<=40||(input.value=input.value.replace(/,/gi,"").split(/(?=(?:\d{3})+$)/).join(","))})})}static dec_addZero(){qsel_all("[id*='-dec']").forEach(input=>{add_event(input,"change",()=>{isNaN(input.value)||1!=input.value.length||(input.value=`0${input.value}`)})})}static password_match(password,confirmPassword,message){add_event(password,"keyup",(function(){this.value==confirmPassword.value&&0!=this.value.length?(remove_class(message,"fa-times"),add_class(message,"fa-check")):this.value!=confirmPassword.value&&confirmPassword.value.length>=1?(remove_class(message,"fa-check"),add_class(message,"fa-times")):0==this.value.length&&(remove_class(message,"fa-check"),remove_class(message,"fa-times"))})),add_event(confirmPassword,"keyup",(function(){this.value==password.value&&0!=this.value.length?(remove_class(message,"fa-times"),add_class(message,"fa-check")):this.value!=password.value&&password.value.length>=1?(remove_class(message,"fa-check"),add_class(message,"fa-times")):0==this.value.length&&(remove_class(message,"fa-check"),remove_class(message,"fa-times"))}))}static reset(){qsel_all("form").forEach(form=>{form.reset()})}}const create_admin=(username,password,adminId)=>{const admin=FnHandler.adminStorage();let adminCheck=admin.findIndex(index=>index.adminId==adminId);if(!admin[adminCheck]){const admin=new Admin(username,password,adminId);FnHandler.addAdmin(admin)}},create_user=(username,password,email,signedUp,firstName,middleName,lastName,gender,accountNumber,accountType,balance)=>{const users=FnHandler.userStorage();let fNameCheck=users.findIndex(index=>index.firstName==firstName),lNameCheck=users.findIndex(index=>index.lastName==lastName);if(users[fNameCheck]&&users[lNameCheck])alert("User already exists!");else{const newUserAccount=new User(username,password,email,signedUp,firstName,middleName,lastName,gender,accountNumber,accountType,balance);newUserAccount.transactionHistory.push(`<em>${FnHandler.time_stamp()}</em> : Opened a ${newUserAccount.accountType.toLowerCase()} account for <strong>${newUserAccount.firstName}</strong> ${newUserAccount.middleName} ${newUserAccount.lastName} with an initial account balance of <strong>â‚±${num_commas(newUserAccount.balance)}</strong>.`),newUserAccount.userTransactionHistory.push(`<em>${FnHandler.time_stamp()}</em> : You have opened a ${newUserAccount.accountType.toLowerCase()} account with an initial account balance of <strong>â‚±${num_commas(newUserAccount.balance)}</strong>.`),FnHandler.addUser(newUserAccount)}};