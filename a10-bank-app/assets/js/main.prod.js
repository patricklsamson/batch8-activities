"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}doc_ready(function(){function a(e,t,n){_classCallCheck(this,a),this.username=e,this.password=t,this.adminId=n}var m,p=function(){function u(e,t,n,a,o,r,c,s,i){var l;return _classCallCheck(this,u),(l=_possibleConstructorReturn(this,_getPrototypeOf(u).call(this,e,t))).firstName=n,l.middleName=a,l.lastName=o,l.gender=r,l.accountNumber=c,l.accountType=s,l.balance=i,l.transactionHistory=[],l}return _inherits(u,a),u}(),g=function(){function p(){_classCallCheck(this,p)}return _createClass(p,null,[{key:"userStorage",value:function(){var e=null===localStorage.getItem("users")?[]:JSON.parse(localStorage.getItem("users"));return e}},{key:"addAdmin",value:function(e){var t=p.userStorage();t.push(e),localStorage.setItem("users",JSON.stringify(t))}},{key:"addUser",value:function(e){var t=p.userStorage();t.push(e),localStorage.setItem("users",JSON.stringify(t))}},{key:"time_stamp",value:function(){var e=new Date,t=e.getMonth()<10?"0".concat(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0".concat(e.getDate()):e.getDate(),a="".concat(t,"/").concat(n,"/").concat(e.getFullYear()),o=e.getHours()<10?"0".concat(e.getHours()):e.getHours(),r=e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes(),c=e.getSeconds()<10?"0".concat(e.getSeconds()):e.getSeconds(),s="".concat(o,":").concat(r,":").concat(c);return"".concat(a," - ").concat(s)}},{key:"withdraw",value:function(t,e){var n,a,o=p.userStorage(),r=o.findIndex(function(e){return e.accountNumber==t});null==o[r]||""==o[r]?alert("User not found!"):parseFloat(o[r].balance)<parseFloat(e)?alert("Not enough money!"):null==parseFloat(e)||""==parseFloat(e)?alert("Enter an amount!"):(n="male"==o[r].gender?"his":"her",o[r].balance=parseFloat(parseFloat(o[r].balance)-parseFloat(e)).toFixed(2),a=parseFloat(parseFloat(o[r].balance)+parseFloat(e)).toFixed(2),o[r].transactionHistory.unshift("<em>".concat(p.time_stamp(),"</em> : Withdrawn an amount of <strong>₱").concat(e,"</strong> from <strong>").concat(o[r].firstName,"</strong>'s account. From a previous account balance of <strong>₱").concat(a,"</strong>, ").concat(n," remaining account balance is now <strong>₱").concat(o[r].balance,"</strong>.")),alert("Withdrawal transaction from ".concat(o[r].firstName,"'s account has been successful!"))),localStorage.setItem("users",JSON.stringify(o))}},{key:"deposit",value:function(t,e){var n,a,o=p.userStorage(),r=o.findIndex(function(e){return e.accountNumber==t});null==o[r]||""==o[r]?alert("User not found!"):null==parseFloat(e)||""==parseFloat(e)?alert("Enter an amount!"):(n="male"==o[r].gender?"his":"her",o[r].balance=parseFloat(parseFloat(o[r].balance)+parseFloat(e)).toFixed(2),a=parseFloat(parseFloat(o[r].balance)-parseFloat(e)).toFixed(2),o[r].transactionHistory.unshift("<em>".concat(p.time_stamp(),"</em> : Deposited an amount of <strong>₱").concat(e,"</strong> into <strong>").concat(o[r].firstName,"</strong>'s account. From a previous account balance of <strong>₱").concat(a,"</strong>, ").concat(n," account balance is now <strong>₱").concat(o[r].balance,"</strong>.")),alert("Deposit transaction from ".concat(o[r].firstName,"'s account has been successful!"))),localStorage.setItem("users",JSON.stringify(o))}},{key:"send",value:function(t,n,e){var a,o,r,c,s=p.userStorage(),i=s.findIndex(function(e){return e.accountNumber==t}),l=s.findIndex(function(e){return e.accountNumber==n});null!=s[i]&&""!=s[i]||null!=s[l]&&""!=s[l]?null==s[i]||""==s[i]?alert("Sender's account not found!"):null==s[l]||""==s[l]?alert("Receiver's account not found!"):parseFloat(s[i].balance)<parseFloat(e)?alert("Not enough money!"):null==parseFloat(e)||""==parseFloat(e)?alert("Enter an amount!"):s[i].accountNumber==s[l].accountNumber?alert("Account number entries are not allowed!"):(a="male"==s[i].gender?"his":"her",o="male"==s[l].gender?"his":"her",s[i].balance=parseFloat(parseFloat(s[i].balance)-parseFloat(e)).toFixed(2),r=parseFloat(parseFloat(s[i].balance)+parseFloat(e)).toFixed(2),s[i].transactionHistory.unshift("<em>".concat(p.time_stamp(),"</em> : Sent an amount of <strong>₱").concat(e,"</strong> from <strong>").concat(s[i].firstName,"</strong>'s account into ").concat(s[l].firstName,"'s account. From <strong>").concat(s[i].firstName,"</strong>'s previous account balance of <strong>₱").concat(r,"</strong>, ").concat(a," remaining account balance is now <strong>₱").concat(s[i].balance,"</strong>.")),s[l].balance=parseFloat(parseFloat(s[l].balance)+parseFloat(e)).toFixed(2),c=parseFloat(parseFloat(s[l].balance)-parseFloat(e)).toFixed(2),s[l].transactionHistory.unshift("<em>".concat(p.time_stamp(),"</em> : Received an amount of <strong>₱").concat(e,"</strong> from ").concat(s[i].firstName,"'s account into <strong>").concat(s[l].firstName,"</strong>'s account. From <strong>").concat(s[l].firstName,"</strong>'s previous account balance of <strong>₱").concat(c,"</strong>, ").concat(o," account balance is now <strong>₱").concat(s[l].balance,"</strong>.")),alert("Successfuly sent money from ".concat(s[i].firstName,"'s account into ").concat(s[l].firstName,"'s account!"))):alert("Users not found!"),localStorage.setItem("users",JSON.stringify(s))}},{key:"get_balance",value:function(t,e){var n=p.userStorage(),a=n.findIndex(function(e){return e.accountNumber==t}),o=create_el("td");n[a]&&(o.innerHTML="₱".concat(num_commas(n[a].balance)),e.appendChild(o))}},{key:"list_users",value:function(){var f=p.userStorage();id("acc-table").innerHTML="";for(m=1;m<f.length;m++)!function(){var e=void 0,t=create_el("tr"),n=create_el("td"),a=create_el("td"),o=create_el("span"),r=create_el("td"),c=create_el("td"),s=create_el("div"),i=create_el("i"),l=create_el("ul"),u=create_el("li");for(n.innerHTML=num_space(f[m].accountNumber),t.appendChild(n),add_event(n,"click",function(){document.execCommand("copy")}),add_event(n,"copy",function(e){e.preventDefault(),e.clipboardData&&e.clipboardData.setData("text/plain",n.textContent)}),o.innerHTML="".concat(f[m].firstName," ").concat(f[m].middleName," ").concat(f[m].lastName),add_class(i,"far"),add_class(i,"fa-times-circle"),add_class(i,"fa-2x"),add_class(l,"xbul"),add_class(l,"wrap-scroll"),1==f[m].transactionHistory.length&&(u.innerHTML="No other transactions yet.",l.appendChild(u)),e=0;e<f[m].transactionHistory.length;e++){var d=create_el("li");d.innerHTML=f[m].transactionHistory[e],add_class(d,"mb-05"),l.appendChild(d)}s.appendChild(i),s.appendChild(l),a.appendChild(o),a.appendChild(s),t.appendChild(a),add_event(o,"click",function(){add_class(s,"show")}),add_event(i,"click",function(){remove_class(s,"show")}),r.innerHTML=f[m].accountType,t.appendChild(r),c.innerHTML='<i id="'.concat(f.indexOf(f[m]),'" class="fas fa-minus-circle"></i>'),add_event(c.querySelector("i"),"click",function(){var e,t=prompt('Are you sure to delete this account?\nType "Y" for yes and "N" for no.',"N");"y"==(null!=t?t.toLowerCase():console.clear())&&((e=JSON.parse(localStorage.getItem("users"))).splice(this.id,1),localStorage.setItem("users",JSON.stringify(e)),p.list_users())}),p.get_balance(f[m].accountNumber,t),t.appendChild(c),id("acc-table").appendChild(t)}()}},{key:"first_char",value:function(){qsel_all("[id*='-name']").forEach(function(e){add_event(e,"keyup",function(){0<e.value.length&&!(31<e.value.charCodeAt(0)&&(e.value.charCodeAt(0)<48||57<e.value.charCodeAt(0)))&&(alert("Invalid input!"),e.value="")})})}},{key:"negative_char",value:function(){qsel_all("[id*='-amount']").forEach(function(t){add_event(t,"keyup",function(e){189==(e.which||e.keyCode)&&(alert("Amount cannot be negative!"),t.id.includes("dec")?t.value="00":t.value="0")})})}},{key:"num_only",value:function(){qsel_all("[id*='-account']").forEach(function(e){add_att(e,"onkeypress","return num_only(event)")}),qsel_all("[id*='-amount']").forEach(function(e){add_att(e,"onkeypress","return num_only(event)")})}},{key:"type_comma",value:function(){qsel_all("[id*='-amount']").forEach(function(t){add_event(t,"keyup",function(e){37<=e.which&&e.which<=40||37<=e.keyCode&&e.keyCode<=40||(t.value=t.value.replace(/,/gi,"").split(/(?=(?:\d{3})+$)/).join(","))})})}},{key:"dec_addZero",value:function(){qsel_all("[id*='-dec']").forEach(function(e){add_event(e,"change",function(){isNaN(e.value)||1!=e.value.length||(e.value="0".concat(e.value))})})}},{key:"reset",value:function(){qsel_all("form").forEach(function(e){e.reset()})}}]),p}();match_height(".mh"),g.list_users(),g.first_char(),g.negative_char(),g.num_only(),g.type_comma(),g.dec_addZero();var e,t,n,o,r,c;t=e="admin",n="1",r=g.userStorage(),c=r.findIndex(function(e){return e.adminId}),r[c]||(o=new a(e,t,n),g.addUser(o));function i(e,t,n,a,o,r,c,s,i){var l,u=g.userStorage(),d=u.findIndex(function(e){return e.firstName==n}),f=u.findIndex(function(e){return e.lastName==o});u[d]&&u[f]?alert("User already exists!"):((l=new p(e,t,n,a,o,r,c,s,i)).transactionHistory.push("<em>".concat(g.time_stamp(),"</em> : Opened a ").concat(l.accountType," account for <strong>").concat(l.firstName,"</strong> ").concat(l.middleName," ").concat(l.lastName," with an initial account balance of <strong>₱").concat(l.balance,"</strong>.")),g.addUser(l))}add_event(id("login-form"),"submit",function(e){e.preventDefault();var t=g.userStorage(),n=t.findIndex(function(e){return e.username==id("login-username").value}),a=t.findIndex(function(e){return e.password==id("login-password").value});return t[n]&&t[a]&&toggle_class(id("modal"),"hide"),!1}),add_event(id("open-signup-btn"),"click",function(){toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show")}),add_event(id("signup-form"),"submit",function(e){return e.preventDefault(),toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show"),!1}),add_event(id("back-signup-btn"),"click",function(){toggle_class(id("login-wrap"),"hide"),toggle_class(id("signup-wrap"),"show")}),add_event(id("load-data-btn"),"click",function(e){e.preventDefault();var t=g.userStorage(),n=t.findIndex(function(e){return"JUAN"==e.firstName}),a=t.findIndex(function(e){return"DELA CRUZ"==e.lastName}),o=t.findIndex(function(e){return"JANE"==e.firstName}),r=t.findIndex(function(e){return"DOE"==e.lastName});if(!t[n]&&!t[a]){var c=prompt('Continuing will load initial data for immediate testing purposes?\nType "Y" to continue or "N" otherwise.',"Y"),s=null!=c?c.toLowerCase():console.clear();if("n"==s||null==s||""==s)return;i("","","JUAN","HERMAN","DELA CRUZ","male","07"+(rand(9e9)+1e9),"Savings",2500.5.toFixed(2))}return t[o]||t[r]||i("","","JANE","HILLS","DOE","female","02"+(rand(9e9)+1e9),"Checking",5200..toFixed(2)),g.list_users(),!1}),add_event(id("log-out-btn"),"click",function(e){return e.preventDefault(),toggle_class(id("modal"),"hide"),g.reset(),!1}),add_event(id("clear-all-btn"),"click",function(){var e=g.userStorage();if(0!=e.length){var t=prompt('Are you sure to delete all stored datas?\nType "Y" for yes and "N" for no.',"N");if("y"!=(null!=t?t.toLowerCase():console.clear()))return;var n=JSON.parse(localStorage.getItem("users"));n.splice(1,e.length),localStorage.setItem("users",JSON.stringify(n)),g.list_users()}}),add_event(id("add-form"),"submit",function(e){e.preventDefault();var t=id("male").checked?"male":"female",n=id("savings").checked?["05","06","07","08","09"]:["01","02","03","04"],a=id("savings").checked?"Savings":"Checking",o=id("savings").checked?2e3:5e3,r=0==id("add-deposit-amount").value.length?"0":id("add-deposit-amount").value.split(",").join(""),c="".concat(r,".").concat(id("add-deposit-amount-dec").value);return i("","",inner(id("add-first-name").value.toUpperCase()),inner(id("add-middle-name").value.toUpperCase()),inner(id("add-last-name").value.toUpperCase()),t,n[rand(n.length)]+(rand(9e9)+1e9),a,parseFloat(o+parseFloat(c)).toFixed(2)),g.list_users(),alert("".concat(id("add-first-name").value.toUpperCase(),"'s account have been successfully created!")),id("add-form").reset(),!1}),add_event(id("withdraw-form"),"submit",function(e){e.preventDefault();var t="".concat(id("withdraw-amount").value.split(",").join(""),".").concat(id("withdraw-amount-dec").value);return g.withdraw(inner(id("withdraw-account").value.split(" ").join("")),t),g.list_users(),id("withdraw-form").reset(),!1}),add_event(id("deposit-form"),"submit",function(e){e.preventDefault();var t="".concat(id("deposit-amount").value.split(",").join(""),".").concat(id("deposit-amount-dec").value);return g.deposit(inner(id("deposit-account").value.split(" ").join("")),t),g.list_users(),id("deposit-form").reset(),!1}),add_event(id("send-form"),"submit",function(e){e.preventDefault();var t="".concat(id("send-amount").value.split(",").join(""),".").concat(id("send-amount-dec").value);return g.send(inner(id("sender-account").value.split(" ").join("")),inner(id("receiver-account").value.split(" ").join("")),t),g.list_users(),id("send-form").reset(),!1})});